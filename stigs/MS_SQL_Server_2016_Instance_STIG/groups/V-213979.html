<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/4473ecc91f70f139-s.p.woff" as="font" crossorigin="" type="font/woff"/><link rel="preload" href="/_next/static/media/463dafcda517f24f-s.p.woff" as="font" crossorigin="" type="font/woff"/><link rel="stylesheet" href="/_next/static/css/a72fe1046a509526.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-9f9d947a63484a6e.js"/><script src="/_next/static/chunks/4bd1b696-03b39f709a189bfa.js" async=""></script><script src="/_next/static/chunks/684-1553ed1d3d36475a.js" async=""></script><script src="/_next/static/chunks/main-app-1dbd084ae3996d5d.js" async=""></script><script src="/_next/static/chunks/167-124eec3043bda3f0.js" async=""></script><script src="/_next/static/chunks/679-b9c39a2233ee1383.js" async=""></script><script src="/_next/static/chunks/app/stigs/%5Bstig_id%5D/groups/%5Bgroup_id%5D/page-1cda043ddf271acd.js" async=""></script><meta name="next-size-adjust" content=""/><title>STIG</title><meta name="description" content="STIG"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><script src="/service-worker.js"></script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_1e4310 __variable_c3aa02 antialiased dark:bg-zinc-900 dark:text-zinc-100"><nav class="bg-white dark:bg-zinc-900 fixed w-full z-20 top-0 start-0 border-b border-zinc-200 dark:border-zinc-700"><div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4"><a href="/" class="flex items-center space-x-3 rtl:space-x-reverse" tabindex="100"><span class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">STIG</span></a><div class="flex md:order-2 space-x-3 md:space-x-0 rtl:space-x-reverse"><div class="relative inline-block text-left"><div><button type="button" class="inline-flex w-full justify-center gap-x-1.5 rounded-md bg-transparent px-3 py-2 text-sm font-semibold text-zinc-500 shadow-sm" id="menu-button" aria-expanded="true" aria-haspopup="true"><svg width="20" height="20" viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" data-slot="icon"><rect width="30" height="3"></rect><rect y="9" width="30" height="3"></rect><rect y="18" width="30" height="3"></rect></svg></button></div></div></div></div></nav><div class="grid grid-rows-[20px_1fr_20px] items-center justify-items-center p-8 pb-20 gap-16 sm:p-20 font-[family-name:var(--font-geist-sans)]"><main class="flex flex-col gap-8 row-start-2 items-center sm:items-start max-w-screen-xl"><aside><span><a class="text-sm text-zinc-400" tabindex="60" href="/stigs">STIGs</a><span class="text-sm mx-2 text-zinc-300"> <!-- -->&gt;<!-- --> </span></span><span><a class="text-sm text-zinc-400" tabindex="60" href="/stigs/MS_SQL_Server_2016_Instance_STIG">MS SQL Server 2016 Instance</a><span class="text-sm mx-2 text-zinc-300"> <!-- -->&gt;<!-- --> </span></span><span><a class="text-sm text-zinc-400" tabindex="60" href="/stigs/MS_SQL_Server_2016_Instance_STIG/groups/SV-213979r961353_rule">V-213979</a></span></aside><section class="w-full flex flex-col"><div class="mb-4"><h4 class="text-2xl">V-213979</h4><h4 class="text-lg">SQL Server must prevent non-privileged users from executing privileged functions, to include disabling, circumventing, or altering implemented security safeguards/countermeasures.</h4><p>medium</p><h4 class="text-lg mt-4">Description</h4><p class="text-base discussion">Preventing non-privileged users from executing privileged functions mitigates the risk that unauthorized individuals or processes may gain unnecessary access to information or privileges.  
 
System documentation should include a definition of the functionality considered privileged. 
 
Depending on circumstances, privileged functions can include, for example, establishing accounts, performing system integrity checks, or administering cryptographic key management activities. Non-privileged users are individuals that do not possess appropriate authorizations. Circumventing intrusion detection and prevention mechanisms or malicious code protection mechanisms are examples of privileged functions that require protection from non-privileged users. 
 
A privileged function in SQL Server/database context is any operation that modifies the structure of the database, its built-in logic, or its security settings. This would include all Data Definition Language (DDL) statements and all security-related statements. In an SQL environment, it encompasses, but is not necessarily limited to:  
CREATE 
ALTER 
DROP 
GRANT 
REVOKE 
DENY 
 
There may also be Data Manipulation Language (DML) statements that, subject to context, should be regarded as privileged. Possible examples include: 
 
TRUNCATE TABLE; 
DELETE, or 
DELETE affecting more than n rows, for some n, or 
DELETE without a WHERE clause; 
 
UPDATE or 
UPDATE affecting more than n rows, for some n, or 
UPDATE without a WHERE clause; 
 
Any SELECT, INSERT, UPDATE, or DELETE to an application-defined security table executed by other than a security principal. 
 
Depending on the capabilities of SQL Server and the design of the database and associated applications, the prevention of unauthorized use of privileged functions may be achieved by means of DBMS security features, database triggers, other mechanisms, or a combination of these.</p><h4 class="text-lg mt-4">Check</h4><p class="text-base discussion">Review server-level securables and built-in role membership to ensure only authorized users have privileged access and the ability to create server-level objects and grant permissions to themselves or others. 
 
Review the system documentation to determine the required levels of protection for DBMS server securables, by type of login. 
 
Review the permissions in place on the server. If the actual permissions do not match the documented requirements, this is a finding. 
 
Get all permission assignments to logins and roles: 
 
SELECT DISTINCT 
    CASE 
        WHEN SP.class_desc IS NOT NULL THEN 
            CASE 
                WHEN SP.class_desc = &#x27;SERVER&#x27; AND S.is_linked = 0 THEN &#x27;SERVER&#x27; 
                WHEN SP.class_desc = &#x27;SERVER&#x27; AND S.is_linked = 1 THEN &#x27;SERVER (linked)&#x27; 
                ELSE SP.class_desc 
            END 
        WHEN E.name IS NOT NULL THEN &#x27;ENDPOINT&#x27; 
        WHEN S.name IS NOT NULL AND S.is_linked = 0 THEN &#x27;SERVER&#x27; 
        WHEN S.name IS NOT NULL AND S.is_linked = 1 THEN &#x27;SERVER (linked)&#x27; 
        WHEN P.name IS NOT NULL THEN &#x27;SERVER_PRINCIPAL&#x27; 
        ELSE &#x27;???&#x27; 
    END                    AS [Securable Class], 
    CASE 
        WHEN E.name IS NOT NULL THEN E.name 
        WHEN S.name IS NOT NULL THEN S.name 
        WHEN P.name IS NOT NULL THEN P.name 
        ELSE &#x27;???&#x27; 
    END                    AS [Securable], 
    P1.name                AS [Grantee], 
    P1.type_desc           AS [Grantee Type], 
    sp.permission_name     AS [Permission], 
    sp.state_desc          AS [State], 
    P2.name                AS [Grantor], 
    P2.type_desc           AS [Grantor Type] 
FROM 
    sys.server_permissions SP 
    INNER JOIN sys.server_principals P1 
        ON P1.principal_id = SP.grantee_principal_id 
    INNER JOIN sys.server_principals P2 
        ON P2.principal_id = SP.grantor_principal_id 
 
    FULL OUTER JOIN sys.servers S 
        ON  SP.class_desc = &#x27;SERVER&#x27; 
        AND S.server_id = SP.major_id 
 
    FULL OUTER JOIN sys.endpoints E 
        ON  SP.class_desc = &#x27;ENDPOINT&#x27; 
        AND E.endpoint_id = SP.major_id 
 
    FULL OUTER JOIN sys.server_principals P 
        ON  SP.class_desc = &#x27;SERVER_PRINCIPAL&#x27;        
        AND P.principal_id = SP.major_id 
 
Get all server role memberships: 
 
SELECT 
    R.name    AS [Role], 
    M.name    AS [Member] 
FROM 
    sys.server_role_members X 
    INNER JOIN sys.server_principals R ON R.principal_id = X.role_principal_id 
    INNER JOIN sys.server_principals M ON M.principal_id = X.member_principal_id 
 
The CONTROL SERVER permission is similar but not identical to the sysadmin fixed server role. Permissions do not imply role memberships and role memberships do not grant permissions. (e.g., CONTROL SERVER does not imply membership in the sysadmin fixed server role.) 
 
Ensure only the documented and approved logins have privileged functions in SQL Server.  
 
If the current configuration does not match the documented baseline, this is a finding.</p><h4 class="text-lg mt-4">Fix</h4><p class="text-base discussion">Restrict the granting of permissions to server-level securables to only those authorized. Most notably, members of sysadmin and securityadmin built-in instance-level roles, CONTROL SERVER permission, and use of the GRANT with GRANT permission.</p></div></section></main><footer class="row-start-3 flex gap-6 flex-wrap items-center justify-center"></footer></div><footer class="bg-white dark:bg-zinc-900 border-t border-zinc-200 dark:border-zinc-700"><div class="w-full max-w-screen-xl mx-auto p-4 md:py-8"><span class="block text-sm text-zinc-500 sm:text-center"><div class="flex flex-row items-center justify-center">Not affiliated with DISA.<a href="https://github.com/nealfennimore/stig" class="block text-sm text-zinc-500 sm:text-center" tabindex="100"><svg class="w-5 h-5 mx-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 .333A9.911 9.911 0 0 0 6.866 19.65c.5.092.678-.215.678-.477 0-.237-.01-1.017-.014-1.845-2.757.6-3.338-1.169-3.338-1.169a2.627 2.627 0 0 0-1.1-1.451c-.9-.615.07-.6.07-.6a2.084 2.084 0 0 1 1.518 1.021 2.11 2.11 0 0 0 2.884.823c.044-.503.268-.973.63-1.325-2.2-.25-4.516-1.1-4.516-4.9A3.832 3.832 0 0 1 4.7 7.068a3.56 3.56 0 0 1 .095-2.623s.832-.266 2.726 1.016a9.409 9.409 0 0 1 4.962 0c1.89-1.282 2.717-1.016 2.717-1.016.366.83.402 1.768.1 2.623a3.827 3.827 0 0 1 1.02 2.659c0 3.807-2.319 4.644-4.525 4.889a2.366 2.366 0 0 1 .673 1.834c0 1.326-.012 2.394-.012 2.72 0 .263.18.572.681.475A9.911 9.911 0 0 0 10 .333Z" clip-rule="evenodd"></path></svg></a></div></span><span class="block text-sm text-zinc-500 sm:text-center">© 2025<!-- --> <a href="https://neal.codes" class="hover:underline" tabindex="70">neal.codes</a>. All Rights Reserved.</span></div></footer><script src="/_next/static/chunks/webpack-9f9d947a63484a6e.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[7555,[],\"\"]\n3:I[1295,[],\"\"]\n5:I[9665,[],\"OutletBoundary\"]\n8:I[9665,[],\"ViewportBoundary\"]\na:I[9665,[],\"MetadataBoundary\"]\nc:I[6614,[],\"\"]\n:HL[\"/_next/static/media/4473ecc91f70f139-s.p.woff\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff\"}]\n:HL[\"/_next/static/media/463dafcda517f24f-s.p.woff\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff\"}]\n:HL[\"/_next/static/css/a72fe1046a509526.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"2L3dML-Ar-FYFJms30i2F\",\"p\":\"\",\"c\":[\"\",\"stigs\",\"MS_SQL_Server_2016_Instance_STIG\",\"groups\",\"V-213979\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"stigs\",{\"children\":[[\"stig_id\",\"MS_SQL_Server_2016_Instance_STIG\",\"d\"],{\"children\":[\"groups\",{\"children\":[[\"group_id\",\"V-213979\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/a72fe1046a509526.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"script\",null,{\"src\":\"/service-worker.js\"}]}],[\"$\",\"body\",null,{\"className\":\"__variable_1e4310 __variable_c3aa02 antialiased dark:bg-zinc-900 dark:text-zinc-100\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"stigs\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"stig_id\",\"MS_SQL_Server_2016_Instance_STIG\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"groups\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"group_id\",\"V-213979\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",\"$undefined\",null,[\"$\",\"$L5\",null,{\"children\":[\"$L6\",\"$L7\",null]}]]}],{},null,false]},null,false]},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"OuKYU5poMqeqOIHpTP4Qq\",{\"children\":[[\"$\",\"$L8\",null,{\"children\":\"$L9\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],[\"$\",\"$La\",null,{\"children\":\"$Lb\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$c\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"d:I[1214,[\"167\",\"static/chunks/167-124eec3043bda3f0.js\",\"679\",\"static/chunks/679-b9c39a2233ee1383.js\",\"402\",\"static/chunks/app/stigs/%5Bstig_id%5D/groups/%5Bgroup_id%5D/page-1cda043ddf271acd.js\"],\"default\"]\ne:I[1102,[\"167\",\"static/chunks/167-124eec3043bda3f0.js\",\"679\",\"static/chunks/679-b9c39a2233ee1383.js\",\"402\",\"static/chunks/app/stigs/%5Bstig_id%5D/groups/%5Bgroup_id%5D/page-1cda043ddf271acd.js\"],\"Navigation\"]\nf:I[2272,[\"167\",\"static/chunks/167-124eec3043bda3f0.js\",\"679\",\"static/chunks/679-b9c39a2233ee1383.js\",\"402\",\"static/chunks/app/stigs/%5Bstig_id%5D/groups/%5Bgroup_id%5D/page-1cda043ddf271acd.js\"],\"default\"]\n10:I[8473,[\"167\",\"static/chunks/167-124eec3043bda3f0.js\",\"679\",\"static/chunks/679-b9c39a2233ee1383.js\",\"402\",\"static/chunks/app/stigs/%5Bstig_id%5D/groups/%5Bgroup_id%5D/page-1cda043ddf271acd.js\"],\"GroupView\"]\n"])</script><script>self.__next_f.push([1,"4:[\"$\",\"$Ld\",null,{\"children\":[[\"$\",\"$Le\",null,{}],[\"$\",\"div\",null,{\"className\":\"grid grid-rows-[20px_1fr_20px] items-center justify-items-center p-8 pb-20 gap-16 sm:p-20 font-[family-name:var(--font-geist-sans)]\",\"children\":[[\"$\",\"main\",null,{\"className\":\"flex flex-col gap-8 row-start-2 items-center sm:items-start max-w-screen-xl\",\"children\":[\"$\",\"$Lf\",null,{\"stigId\":\"MS_SQL_Server_2016_Instance_STIG\",\"children\":[\"$\",\"$L10\",null,{\"stigId\":\"MS_SQL_Server_2016_Instance_STIG\",\"groupId\":\"V-213979\"}]}]}],[\"$\",\"footer\",null,{\"className\":\"row-start-3 flex gap-6 flex-wrap items-center justify-center\"}]]}],[\"$\",\"footer\",null,{\"className\":\"bg-white dark:bg-zinc-900 border-t border-zinc-200 dark:border-zinc-700\",\"children\":[\"$\",\"div\",null,{\"className\":\"w-full max-w-screen-xl mx-auto p-4 md:py-8\",\"children\":[[\"$\",\"span\",null,{\"className\":\"block text-sm text-zinc-500 sm:text-center\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-row items-center justify-center\",\"children\":[\"Not affiliated with DISA.\",[\"$\",\"a\",null,{\"href\":\"https://github.com/nealfennimore/stig\",\"className\":\"block text-sm text-zinc-500 sm:text-center\",\"tabIndex\":100,\"children\":[\"$\",\"svg\",null,{\"className\":\"w-5 h-5 mx-4\",\"aria-hidden\":\"true\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"children\":[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M10 .333A9.911 9.911 0 0 0 6.866 19.65c.5.092.678-.215.678-.477 0-.237-.01-1.017-.014-1.845-2.757.6-3.338-1.169-3.338-1.169a2.627 2.627 0 0 0-1.1-1.451c-.9-.615.07-.6.07-.6a2.084 2.084 0 0 1 1.518 1.021 2.11 2.11 0 0 0 2.884.823c.044-.503.268-.973.63-1.325-2.2-.25-4.516-1.1-4.516-4.9A3.832 3.832 0 0 1 4.7 7.068a3.56 3.56 0 0 1 .095-2.623s.832-.266 2.726 1.016a9.409 9.409 0 0 1 4.962 0c1.89-1.282 2.717-1.016 2.717-1.016.366.83.402 1.768.1 2.623a3.827 3.827 0 0 1 1.02 2.659c0 3.807-2.319 4.644-4.525 4.889a2.366 2.366 0 0 1 .673 1.834c0 1.326-.012 2.394-.012 2.72 0 .263.18.572.681.475A9.911 9.911 0 0 0 10 .333Z\",\"clipRule\":\"evenodd\"}]}]}]]}]}],[\"$\",\"span\",null,{\"className\":\"block text-sm text-zinc-500 sm:text-center\",\"children\":[\"© 2025\",\" \",[\"$\",\"a\",null,{\"href\":\"https://neal.codes\",\"className\":\"hover:underline\",\"tabIndex\":70,\"children\":\"neal.codes\"}],\". All Rights Reserved.\"]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"9:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n6:null\n"])</script><script>self.__next_f.push([1,"7:null\nb:[[\"$\",\"title\",\"0\",{\"children\":\"STIG\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"STIG\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]]\n"])</script></body></html>