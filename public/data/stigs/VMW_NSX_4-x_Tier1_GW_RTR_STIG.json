{
  "+p_xml": "version=\"1.0\" encoding=\"utf-8\"",
  "+p_xml-stylesheet": "type='text/xsl' href='STIG_unclass.xsl'",
  "Benchmark": {
    "+@xmlns:dc": "http://purl.org/dc/elements/1.1/",
    "+@xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
    "+@xmlns:cpe": "http://cpe.mitre.org/language/2.0",
    "+@xmlns:xhtml": "http://www.w3.org/1999/xhtml",
    "+@xmlns:dsig": "http://www.w3.org/2000/09/xmldsig#",
    "+@xsi:schemaLocation": "http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd",
    "+@id": "VMW_NSX_4-x_Tier1_GW_RTR_STIG",
    "+@xml:lang": "en",
    "+@xmlns": "http://checklists.nist.gov/xccdf/1.1",
    "status": {
      "+content": "accepted",
      "+@date": "2024-12-20"
    },
    "title": "VMware NSX 4.x Tier-1 Gateway Router Security Technical Implementation Guide",
    "description": "This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.",
    "notice": {
      "+@id": "terms-of-use",
      "+@xml:lang": "en"
    },
    "front-matter": {
      "+@xml:lang": "en"
    },
    "rear-matter": {
      "+@xml:lang": "en"
    },
    "reference": {
      "+@href": "https://cyber.mil",
      "publisher": "DISA",
      "source": "STIG.DOD.MIL"
    },
    "plain-text": [
      {
        "+content": "Release: 2 Benchmark Date: 30 Jan 2025",
        "+@id": "release-info"
      },
      {
        "+content": "3.5",
        "+@id": "generator"
      },
      {
        "+content": "1.10.0",
        "+@id": "conventionsVersion"
      }
    ],
    "version": "1",
    "Profile": [
      {
        "+@id": "MAC-1_Classified",
        "title": "I - Mission Critical Classified",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265518",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265529",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265604",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265608",
            "+@selected": "true"
          }
        ]
      },
      {
        "+@id": "MAC-1_Public",
        "title": "I - Mission Critical Public",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265518",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265529",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265604",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265608",
            "+@selected": "true"
          }
        ]
      },
      {
        "+@id": "MAC-1_Sensitive",
        "title": "I - Mission Critical Sensitive",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265518",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265529",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265604",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265608",
            "+@selected": "true"
          }
        ]
      },
      {
        "+@id": "MAC-2_Classified",
        "title": "II - Mission Support Classified",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265518",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265529",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265604",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265608",
            "+@selected": "true"
          }
        ]
      },
      {
        "+@id": "MAC-2_Public",
        "title": "II - Mission Support Public",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265518",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265529",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265604",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265608",
            "+@selected": "true"
          }
        ]
      },
      {
        "+@id": "MAC-2_Sensitive",
        "title": "II - Mission Support Sensitive",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265518",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265529",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265604",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265608",
            "+@selected": "true"
          }
        ]
      },
      {
        "+@id": "MAC-3_Classified",
        "title": "III - Administrative Classified",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265518",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265529",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265604",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265608",
            "+@selected": "true"
          }
        ]
      },
      {
        "+@id": "MAC-3_Public",
        "title": "III - Administrative Public",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265518",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265529",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265604",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265608",
            "+@selected": "true"
          }
        ]
      },
      {
        "+@id": "MAC-3_Sensitive",
        "title": "III - Administrative Sensitive",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265518",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265529",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265604",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265608",
            "+@selected": "true"
          }
        ]
      }
    ],
    "Group": [
      {
        "+@id": "V-265518",
        "title": "SRG-NET-000019-RTR-000007",
        "description": "<GroupDescription></GroupDescription>",
        "Rule": {
          "+@id": "SV-265518r999924_rule",
          "+@weight": "10.0",
          "+@severity": "high",
          "version": "NT1R-4X-000016",
          "title": "The NSX Tier-1 Gateway router must be configured to have all inactive interfaces removed.",
          "description": "<VulnDiscussion>An inactive interface is rarely monitored or controlled and may expose a network to an undetected attack on that interface. Unauthorized personnel with access to the communication facility could gain access to a router by connecting to a configured interface that is not in use.\n\nIf an interface is no longer used, the configuration must be deleted and the interface disabled. For sub-interfaces, delete sub-interfaces that are on inactive interfaces and delete sub-interfaces that are themselves inactive. If the sub-interface is no longer necessary for authorized communications, it must be deleted.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
          "reference": {
            "title": "DPMS Target VMware NSX 4.x Tier-1 Gateway Router",
            "publisher": "DISA",
            "type": "DPMS Target",
            "subject": "VMware NSX 4.x Tier-1 Gateway Router",
            "identifier": "5635"
          },
          "ident": {
            "+content": "CCI-001414",
            "+@system": "http://cyber.mil/cci"
          },
          "fixtext": {
            "+content": "To remove a stale linked segment from a Tier-1 Gateway, do the following:\n\nFrom the NSX Manager web interface, go to Networking >> Connectivity >> Segments and edit the target segment.\n\nUnder Connected Gateway, change to \"None\" and click \"Save\".\n\nNote: The stale linked segment can also be deleted if there are no active workloads attached to it.\n\nTo remove a stale service interface from a Tier-1 Gateway, do the following:\n\nFrom the NSX Manager web interface, go to Networking >> Connectivity >> Tier-1 Gateways >> Edit the target Tier-1 gateway.\n\nExpand \"Interfaces and GRE Tunnels\", then click on the number of interfaces present to open the interfaces dialog.\n\nOn the stale service interface, select \"Delete\" and click \"Delete\" again to confirm.",
            "+@fixref": "F-69343r999924_fix"
          },
          "fix": {
            "+@id": "F-69343r999924_fix"
          },
          "check": {
            "+@system": "C-69435r995025_chk",
            "check-content-ref": {
              "+@href": "VMware_NSX_4.x_Tier-1_Gateway_Router_STIG.xml",
              "+@name": "M"
            },
            "check-content": "From the NSX Manager web interface, go to Networking >> Connectivity >> Tier-1 Gateways.\n\nFor every Tier-1 Gateway, expand the Tier-1 Gateway. Click on the number in the Linked Segments to review the currently linked segments.\n\nFor every Tier-1 Gateway, expand the Tier-1 Gateway. Expand Interfaces and GRE Tunnels, and click on the number of interfaces present to open the interfaces dialog.\n\nReview each interface or linked segment present to determine if they are not in use or inactive.\n\nIf there are any linked segments or service interfaces present on a Tier-1 Gateway that are not in use or inactive, this is a finding."
          }
        }
      },
      {
        "+@id": "V-265529",
        "title": "SRG-NET-000131-RTR-000035",
        "description": "<GroupDescription></GroupDescription>",
        "Rule": {
          "+@id": "SV-265529r999926_rule",
          "+@weight": "10.0",
          "+@severity": "low",
          "version": "NT1R-4X-000027",
          "title": "The NSX Tier-1 Gateway router must be configured to have the DHCP service disabled if not in use.",
          "description": "<VulnDiscussion>A compromised router introduces risk to the entire network infrastructure, as well as data resources that are accessible via the network. The perimeter defense has no oversight or control of attacks by malicious users within the network. Preventing network breaches from within is dependent on implementing a comprehensive defense-in-depth strategy, including securing each device connected to the network. This is accomplished by following and implementing all security guidance applicable for each node type. A fundamental step in securing each router is to enable only the capabilities required for operation.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
          "reference": {
            "title": "DPMS Target VMware NSX 4.x Tier-1 Gateway Router",
            "publisher": "DISA",
            "type": "DPMS Target",
            "subject": "VMware NSX 4.x Tier-1 Gateway Router",
            "identifier": "5635"
          },
          "ident": {
            "+content": "CCI-000381",
            "+@system": "http://cyber.mil/cci"
          },
          "fixtext": {
            "+content": "From the NSX Manager web interface, go to Networking >> Connectivity >> Tier-1 Gateways and edit the target Tier-1 gateway.\n\nClick \"Set DHCP Configuration\", select \"No Dynamic IP Address Allocation\", click \"Save\", and then close \"Editing\".",
            "+@fixref": "F-69354r999926_fix"
          },
          "fix": {
            "+@id": "F-69354r999926_fix"
          },
          "check": {
            "+@system": "C-69446r995058_chk",
            "check-content-ref": {
              "+@href": "VMware_NSX_4.x_Tier-1_Gateway_Router_STIG.xml",
              "+@name": "M"
            },
            "check-content": "From the NSX Manager web interface, go to Networking >> Connectivity >> Tier-1 Gateways.\n\nFor every Tier-1 Gateway expand the Tier-1 Gateway to view the DHCP configuration.\n\nIf a DHCP profile is configured and not in use, this is a finding."
          }
        }
      },
      {
        "+@id": "V-265604",
        "title": "SRG-NET-000512-RTR-000012",
        "description": "<GroupDescription></GroupDescription>",
        "Rule": {
          "+@id": "SV-265604r995285_rule",
          "+@weight": "10.0",
          "+@severity": "low",
          "version": "NT1R-4X-000102",
          "title": "The NSX Tier-1 Gateway router must be configured to advertise a hop limit of at least 32 in Router Advertisement messages for IPv6 stateless auto-configuration deployments.",
          "description": "<VulnDiscussion>The Neighbor Discovery protocol allows a hop limit value to be advertised by routers in a Router Advertisement message being used by hosts instead of the standardized default value. If a very small value was configured and advertised to hosts on the LAN segment, communications would fail due to the hop limit reaching zero before the packets sent by a host reached its destination.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
          "reference": {
            "title": "DPMS Target VMware NSX 4.x Tier-1 Gateway Router",
            "publisher": "DISA",
            "type": "DPMS Target",
            "subject": "VMware NSX 4.x Tier-1 Gateway Router",
            "identifier": "5635"
          },
          "ident": {
            "+content": "CCI-000366",
            "+@system": "http://cyber.mil/cci"
          },
          "fixtext": {
            "+content": "To configure the Neighbor Discovery hop limit, do the following:\n\nFrom the NSX Manager web interface, go to Networking >> Connectivity >> Tier-1 Gateways >> edit the target Tier-1 gateway.\n\nExpand Additional Settings and select an \"ND Profile\" from the drop down with a hop limit of 32 or more, then click \"Close Editing\".\n\nNote: The default ND profile has a hop limit of 64 and cannot be edited. If required, create a new or edit another existing ND profile to use.",
            "+@fixref": "F-69429r995284_fix"
          },
          "fix": {
            "+@id": "F-69429r995284_fix"
          },
          "check": {
            "+@system": "C-69521r995283_chk",
            "check-content-ref": {
              "+@href": "VMware_NSX_4.x_Tier-1_Gateway_Router_STIG.xml",
              "+@name": "M"
            },
            "check-content": "If IPv6 forwarding is not enabled, this is Not Applicable.\n\nFrom the NSX Manager web interface, go to Networking >> Connectivity >> Tier-1 Gateways.\n\nFor every Tier-1 Gateway, expand Tier-1 Gateway >>Additional Settings.\n\nClick on the ND profile name to view the hop limit.\n\nIf the hop limit is not configured to at least 32, this is a finding."
          }
        }
      },
      {
        "+@id": "V-265608",
        "title": "SRG-NET-000131-RTR-000035",
        "description": "<GroupDescription></GroupDescription>",
        "Rule": {
          "+@id": "SV-265608r999927_rule",
          "+@weight": "10.0",
          "+@severity": "low",
          "version": "NT1R-4X-000107",
          "title": "The NSX Tier-1 Gateway router must be configured to have multicast disabled if not in use.",
          "description": "<VulnDiscussion>A compromised router introduces risk to the entire network infrastructure, as well as data resources that are accessible via the network. The perimeter defense has no oversight or control of attacks by malicious users within the network. Preventing network breaches from within is dependent on implementing a comprehensive defense-in-depth strategy, including securing each device connected to the network. This is accomplished by following and implementing all security guidance applicable for each node type. A fundamental step in securing each router is to enable only the capabilities required for operation.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
          "reference": {
            "title": "DPMS Target VMware NSX 4.x Tier-1 Gateway Router",
            "publisher": "DISA",
            "type": "DPMS Target",
            "subject": "VMware NSX 4.x Tier-1 Gateway Router",
            "identifier": "5635"
          },
          "ident": {
            "+content": "CCI-000381",
            "+@system": "http://cyber.mil/cci"
          },
          "fixtext": {
            "+content": "If not used, disable Multicast by doing the following:\n\nFrom the NSX Manager web interface, go to Networking >> Connectivity >> Tier-1 Gateways and edit the target Tier-1 gateway.\n\nExpand Multicast and change from \"Enabled\" to \"Disabled\" and then click \"Save\".",
            "+@fixref": "F-69433r999927_fix"
          },
          "fix": {
            "+@id": "F-69433r999927_fix"
          },
          "check": {
            "+@system": "C-69525r995295_chk",
            "check-content-ref": {
              "+@href": "VMware_NSX_4.x_Tier-1_Gateway_Router_STIG.xml",
              "+@name": "M"
            },
            "check-content": "From the NSX Manager web interface, go to Networking >> Connectivity >> Tier-1 Gateways.\n\nFor every Tier-1 Gateway, expand the Tier-1 Gateway then expand Multicast to view the Multicast configuration.\n\nIf Multicast is enabled and not in use, this is a finding.\n\nIf a Tier-1 Gateway is not linked to a Tier-0 Gateway, this is Not Applicable."
          }
        }
      }
    ]
  }
}
