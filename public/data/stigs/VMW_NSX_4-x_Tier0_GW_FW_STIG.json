{
  "+p_xml": "version=\"1.0\" encoding=\"utf-8\"",
  "+p_xml-stylesheet": "type='text/xsl' href='STIG_unclass.xsl'",
  "Benchmark": {
    "+@xmlns:dc": "http://purl.org/dc/elements/1.1/",
    "+@xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
    "+@xmlns:cpe": "http://cpe.mitre.org/language/2.0",
    "+@xmlns:xhtml": "http://www.w3.org/1999/xhtml",
    "+@xmlns:dsig": "http://www.w3.org/2000/09/xmldsig#",
    "+@xsi:schemaLocation": "http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd",
    "+@id": "VMW_NSX_4-x_Tier0_GW_FW_STIG",
    "+@xml:lang": "en",
    "+@xmlns": "http://checklists.nist.gov/xccdf/1.1",
    "status": {
      "+content": "accepted",
      "+@date": "2024-12-13"
    },
    "title": "VMware NSX 4.x Tier-0 Gateway Firewall Security Technical Implementation Guide",
    "description": "This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.",
    "notice": {
      "+@id": "terms-of-use",
      "+@xml:lang": "en"
    },
    "front-matter": {
      "+@xml:lang": "en"
    },
    "rear-matter": {
      "+@xml:lang": "en"
    },
    "reference": {
      "+@href": "https://cyber.mil",
      "publisher": "DISA",
      "source": "STIG.DOD.MIL"
    },
    "plain-text": [
      {
        "+content": "Release: 2 Benchmark Date: 30 Jan 2025",
        "+@id": "release-info"
      },
      {
        "+content": "3.5",
        "+@id": "generator"
      },
      {
        "+content": "1.10.0",
        "+@id": "conventionsVersion"
      }
    ],
    "version": "1",
    "Profile": [
      {
        "+@id": "MAC-1_Classified",
        "title": "I - Mission Critical Classified",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265362",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265367",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265368",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265370",
            "+@selected": "true"
          }
        ]
      },
      {
        "+@id": "MAC-1_Public",
        "title": "I - Mission Critical Public",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265362",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265367",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265368",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265370",
            "+@selected": "true"
          }
        ]
      },
      {
        "+@id": "MAC-1_Sensitive",
        "title": "I - Mission Critical Sensitive",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265362",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265367",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265368",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265370",
            "+@selected": "true"
          }
        ]
      },
      {
        "+@id": "MAC-2_Classified",
        "title": "II - Mission Support Classified",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265362",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265367",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265368",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265370",
            "+@selected": "true"
          }
        ]
      },
      {
        "+@id": "MAC-2_Public",
        "title": "II - Mission Support Public",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265362",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265367",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265368",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265370",
            "+@selected": "true"
          }
        ]
      },
      {
        "+@id": "MAC-2_Sensitive",
        "title": "II - Mission Support Sensitive",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265362",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265367",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265368",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265370",
            "+@selected": "true"
          }
        ]
      },
      {
        "+@id": "MAC-3_Classified",
        "title": "III - Administrative Classified",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265362",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265367",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265368",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265370",
            "+@selected": "true"
          }
        ]
      },
      {
        "+@id": "MAC-3_Public",
        "title": "III - Administrative Public",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265362",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265367",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265368",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265370",
            "+@selected": "true"
          }
        ]
      },
      {
        "+@id": "MAC-3_Sensitive",
        "title": "III - Administrative Sensitive",
        "description": "<ProfileDescription></ProfileDescription>",
        "select": [
          {
            "+@idref": "V-265362",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265367",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265368",
            "+@selected": "true"
          },
          {
            "+@idref": "V-265370",
            "+@selected": "true"
          }
        ]
      }
    ],
    "Group": [
      {
        "+@id": "V-265362",
        "title": "SRG-NET-000074-FW-000009",
        "description": "<GroupDescription></GroupDescription>",
        "Rule": {
          "+@id": "SV-265362r994329_rule",
          "+@weight": "10.0",
          "+@severity": "medium",
          "version": "NT0F-4X-000004",
          "title": "The NSX Tier-0 Gateway Firewall must generate traffic log entries.",
          "description": "<VulnDiscussion>Without establishing what type of event occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.\n\nAudit event content that may be necessary to satisfy this requirement includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.\n\nAssociating event types with detected events in the network element logs provides a means of investigating an attack, recognizing resource usage or capacity thresholds, or identifying an improperly configured network element.\n\nSatisfies: SRG-NET-000074-FW-000009, SRG-NET-000061-FW-000001, SRG-NET-000075-FW-000010, SRG-NET-000076-FW-000011, SRG-NET-000077-FW-000012, SRG-NET-000078-FW-000013, SRG-NET-000492-FW-000006, SRG-NET-000493-FW-000007</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
          "reference": {
            "title": "DPMS Target VMware NSX 4.x Tier-0 Gateway Firewall",
            "publisher": "DISA",
            "type": "DPMS Target",
            "subject": "VMware NSX 4.x Tier-0 Gateway Firewall",
            "identifier": "5631"
          },
          "ident": [
            {
              "+content": "CCI-000130",
              "+@system": "http://cyber.mil/cci"
            },
            {
              "+content": "CCI-000067",
              "+@system": "http://cyber.mil/cci"
            },
            {
              "+content": "CCI-000131",
              "+@system": "http://cyber.mil/cci"
            },
            {
              "+content": "CCI-000132",
              "+@system": "http://cyber.mil/cci"
            },
            {
              "+content": "CCI-000133",
              "+@system": "http://cyber.mil/cci"
            },
            {
              "+content": "CCI-000134",
              "+@system": "http://cyber.mil/cci"
            },
            {
              "+content": "CCI-000172",
              "+@system": "http://cyber.mil/cci"
            }
          ],
          "fixtext": {
            "+content": "From the NSX Manager web interface, go to Security >> Policy Management >> Gateway Firewall >> Gateway Specific Rules.\n\nFor each Tier-0 Gateway and for each rule with logging disabled, click the gear icon, enable logging, and then click \"Apply\".\n\nAfter all changes are made, click \"Publish\".",
            "+@fixref": "F-69187r994328_fix"
          },
          "fix": {
            "+@id": "F-69187r994328_fix"
          },
          "check": {
            "+@system": "C-69279r994327_chk",
            "check-content-ref": {
              "+@href": "VMware_NSX_4.x_Tier-0_Gateway_Firewall_STIG.xml",
              "+@name": "M"
            },
            "check-content": "If the Tier-0 Gateway is deployed in an Active/Active HA mode and no stateless rules exist, this is Not Applicable.\n\nFrom the NSX Manager web interface, go to Security >> Policy Management >> Gateway Firewall >> Gateway Specific Rules.\n\nFor each Tier-0 Gateway and for each rule, click the gear icon and verify the logging setting.\n\nIf logging is not enabled, this is a finding."
          }
        }
      },
      {
        "+@id": "V-265367",
        "title": "SRG-NET-000193-FW-000030",
        "description": "<GroupDescription></GroupDescription>",
        "Rule": {
          "+@id": "SV-265367r994344_rule",
          "+@weight": "10.0",
          "+@severity": "high",
          "version": "NT0F-4X-000015",
          "title": "The NSX Tier-0 Gateway Firewall must manage excess bandwidth to limit the effects of packet flooding types of denial-of-service (DoS) attacks.",
          "description": "<VulnDiscussion>A firewall experiencing a DoS attack will not be able to handle production traffic load. The high usage and CPU caused by a DoS attack will impact control of keep-alives and timers used for neighbor peering. This will result in route flapping and will eventually black hole production traffic.\n\nThe device must be configured to contain and limit a DoS attack's effect on the device's resource usage. The use of redundant components and load balancing are examples of mitigating \"flood-type\" DoS attacks through increased capacity.\n\nSatisfies: SRG-NET-000193-FW-000030, SRG-NET-000192-FW-000029, SRG-NET-000362-FW-000028</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
          "reference": {
            "title": "DPMS Target VMware NSX 4.x Tier-0 Gateway Firewall",
            "publisher": "DISA",
            "type": "DPMS Target",
            "subject": "VMware NSX 4.x Tier-0 Gateway Firewall",
            "identifier": "5631"
          },
          "ident": [
            {
              "+content": "CCI-001095",
              "+@system": "http://cyber.mil/cci"
            },
            {
              "+content": "CCI-001094",
              "+@system": "http://cyber.mil/cci"
            },
            {
              "+content": "CCI-002385",
              "+@system": "http://cyber.mil/cci"
            }
          ],
          "fixtext": {
            "+content": "To create a new Flood Protection profile, do the following:\n\nFrom the NSX Manager web interface, go to Security >> Settings >> General Settings >> Firewall >> Flood Protection >> Add Profile >> Add Edge Gateway Profile.\n\nEnter a name and specify appropriate values for the following: TCP Half Open Connection limit, UDP Active Flow Limit, ICMP Active Flow Limit, and Other Active Connection Limit.\n\nConfigure the \"Applied To\" field to contain Tier-0 Gateways, and then click \"Save\".",
            "+@fixref": "F-69192r994343_fix"
          },
          "fix": {
            "+@id": "F-69192r994343_fix"
          },
          "check": {
            "+@system": "C-69284r994342_chk",
            "check-content-ref": {
              "+@href": "VMware_NSX_4.x_Tier-0_Gateway_Firewall_STIG.xml",
              "+@name": "M"
            },
            "check-content": "If the Tier-0 Gateway is deployed in an Active/Active HA mode and no stateless rules exist, this is Not Applicable.\n\nFrom the NSX Manager web interface, go to Security >> Settings >> General Settings >> Firewall >> Flood Protection to view Flood Protection profiles.\n\nIf there are no Flood Protection profiles of type \"Gateway\", this is a finding.\n\nFor each gateway flood protection profile, if TCP Half Open Connection limit, UDP Active Flow Limit, ICMP Active Flow Limit, and Other Active Connection Limit are set to \"None\", this is a finding.\n\nFor each gateway flood protection profile, examine the \"Applied To\" field to view the Tier-0 Gateways to which it is applied.\n\nIf a gateway flood protection profile is not applied to all applicable Tier-0 Gateways through one or more policies, this is a finding."
          }
        }
      },
      {
        "+@id": "V-265368",
        "title": "SRG-NET-000202-FW-000039",
        "description": "<GroupDescription></GroupDescription>",
        "Rule": {
          "+@id": "SV-265368r994347_rule",
          "+@weight": "10.0",
          "+@severity": "medium",
          "version": "NT0F-4X-000016",
          "title": "The NSX Tier-0 Gateway Firewall must deny network communications traffic by default and allow network communications traffic by exception.",
          "description": "<VulnDiscussion>To prevent malicious or accidental leakage of traffic, organizations must implement a deny-by-default security posture at the network perimeter. Such rulesets prevent many malicious exploits or accidental leakage by restricting the traffic to only known sources and only those ports, protocols, or services that are permitted and operationally necessary.\n\nAs a managed boundary interface, the firewall must block all inbound and outbound network traffic unless a filter is installed to explicitly allow it. The allow filters must comply with the Ports, Protocols, and Services Management (PPSM) Category Assurance List (CAL) and Vulnerability Assessment (VA).\n\nSatisfies: SRG-NET-000202-FW-000039, SRG-NET-000205-FW-000040, SRG-NET-000235-FW-000133, SRG-NET-000364-FW-000031</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
          "reference": {
            "title": "DPMS Target VMware NSX 4.x Tier-0 Gateway Firewall",
            "publisher": "DISA",
            "type": "DPMS Target",
            "subject": "VMware NSX 4.x Tier-0 Gateway Firewall",
            "identifier": "5631"
          },
          "ident": [
            {
              "+content": "CCI-001109",
              "+@system": "http://cyber.mil/cci"
            },
            {
              "+content": "CCI-001097",
              "+@system": "http://cyber.mil/cci"
            },
            {
              "+content": "CCI-001190",
              "+@system": "http://cyber.mil/cci"
            },
            {
              "+content": "CCI-002403",
              "+@system": "http://cyber.mil/cci"
            }
          ],
          "fixtext": {
            "+content": "From the NSX Manager web interface, go to Security >> Policy Management >> Gateway Firewall >> Gateway Specific Rules.\n\nChoose each Tier-0 Gateway in drop-down, then select Policy_Default_Infra Section >> Action.\n\nChange the Action to \"Drop\" or \"Reject\", and then click \"Publish\".",
            "+@fixref": "F-69193r994346_fix"
          },
          "fix": {
            "+@id": "F-69193r994346_fix"
          },
          "check": {
            "+@system": "C-69285r994345_chk",
            "check-content-ref": {
              "+@href": "VMware_NSX_4.x_Tier-0_Gateway_Firewall_STIG.xml",
              "+@name": "M"
            },
            "check-content": "From the NSX Manager web interface, go to Security >> Policy Management >> Gateway Firewall >> Gateway Specific Rules.\n\nChoose each Tier-0 Gateway in drop-down, then select Policy_Default_Infra Section >> Action.\n\nIf the default_rule is set to \"Allow\", this is a finding."
          }
        }
      },
      {
        "+@id": "V-265370",
        "title": "SRG-NET-000333-FW-000014",
        "description": "<GroupDescription></GroupDescription>",
        "Rule": {
          "+@id": "SV-265370r994353_rule",
          "+@weight": "10.0",
          "+@severity": "medium",
          "version": "NT0F-4X-000020",
          "title": "The NSX Tier-0 Gateway Firewall must be configured to send traffic log entries to a central log server.",
          "description": "<VulnDiscussion>Without the ability to centrally manage the content captured in the traffic log entries, identification, troubleshooting, and correlation of suspicious behavior would be difficult and could lead to a delayed or incomplete analysis of an ongoing attack.\n\nThe DOD requires centralized management of all network component audit record content. Network components requiring centralized traffic log management must have the ability to support centralized management. The content captured in traffic log entries must be managed from a central location (necessitating automation). Centralized management of traffic log records and logs provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records. \n\nEnsure at least one syslog server is configured on the firewall.\n\nIf the product inherently has the ability to store log records locally, the local log must also be secured. However, this requirement is not met since it calls for a use of a central audit server.\n\nSatisfies: SRG-NET-000333-FW-000014, SRG-NET-000098-FW-000021</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
          "reference": {
            "title": "DPMS Target VMware NSX 4.x Tier-0 Gateway Firewall",
            "publisher": "DISA",
            "type": "DPMS Target",
            "subject": "VMware NSX 4.x Tier-0 Gateway Firewall",
            "identifier": "5631"
          },
          "ident": [
            {
              "+content": "CCI-001851",
              "+@system": "http://cyber.mil/cci"
            },
            {
              "+content": "CCI-000366",
              "+@system": "http://cyber.mil/cci"
            }
          ],
          "fixtext": {
            "+content": "To configure a profile to apply syslog servers to all NSX Edge Nodes, do the following:\n\nFrom the NSX Manager web interface, go to System >> Configuration >> Fabric >> Profiles >> Node Profiles.\n\nClick \"All NSX Nodes\" and then under \"Syslog Servers\", click \"Add\".\n\nEnter the syslog server details, choose \"Information\" for the log level, and click \"Add\".\n\nor\n\n(Optional) From an NSX Edge Node shell, run the following command to clear any existing incorrect logging servers:\n\n> clear logging-servers\n\nFrom an NSX Edge Node shell, run the following command to configure a TCP syslog server:\n\n> set logging-server <server-ip or server-name> proto tcp level info\n\nFrom an NSX Edge Node shell, run the following command to configure a primary and backup TLS syslog server:\n\n> set logging-server <server-ip or server-name> proto tls level info serverca ca.pem clientca ca.pem certificate cert.pem key key.pem\n\nFrom an NSX Edge Node shell, run the following command to configure an LI-TLS syslog server:\n\n> set logging-server <server-ip or server-name> proto li-tls level info serverca root-ca.crt\n\nNote: If using the protocols TLS or LI-TLS to configure a secure connection to a log server, the server and client certificates must be stored in /var/vmware/nsx/file-store/ on each NSX Edge Node appliance.\n\nNote: Configure the syslog to send an alert if the events server is unable to receive events from the NSX-T and also if denial-of-service (DoS) incidents are detected. This is true if the events server is STIG compliant.",
            "+@fixref": "F-69195r994352_fix"
          },
          "fix": {
            "+@id": "F-69195r994352_fix"
          },
          "check": {
            "+@system": "C-69287r994351_chk",
            "check-content-ref": {
              "+@href": "VMware_NSX_4.x_Tier-0_Gateway_Firewall_STIG.xml",
              "+@name": "M"
            },
            "check-content": "From an NSX Edge Node shell hosting the Tier-0 Gateway, run the following command:\n\n> get logging-servers\n\nNote: This check must be run from each NSX Edge Node hosting a Tier-0 Gateway, as they are configured individually.\n\nor\n\nIf Node Profiles are used, from the NSX Manager web interface, go to System >> Configuration >> Fabric >> Profiles >> Node Profiles.\n\nClick \"All NSX Nodes\" and verify the syslog servers listed.\n\nIf any configured logging servers are configured with a protocol of \"udp\", this is a finding.\n\nIf any logging servers are not configured with a level of \"info\", this is a finding.\n\nIf no logging servers are configured, this is a finding."
          }
        }
      }
    ]
  }
}
