(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[92,843],{2176:(e,t,r)=>{Promise.resolve().then(r.bind(r,1102)),Promise.resolve().then(r.bind(r,6261)),Promise.resolve().then(r.bind(r,1214)),Promise.resolve().then(r.bind(r,2272))},2272:(e,t,r)=>{"use strict";r.d(t,{KR:()=>a,default:()=>o});var s=r(5155),l=r(2072),i=r(2115);let n=(0,i.createContext)(null);function c(e){let{children:t,value:r}=e;return(0,s.jsx)(n.Provider,{value:r,children:t})}function a(){return(0,i.use)(function(){let e=(0,i.useContext)(n);if(!e)throw Error("useStigContext must be used within a StigProvider");return e}())}function o(e){let{stigId:t,children:r}=e,i=l.Ay.read("".concat(t,".json"));return(0,s.jsx)(c,{value:i,children:r})}},3522:(e,t,r)=>{"use strict";r.d(t,{B:()=>c});var s=r(5155),l=r(1214),i=r(6874),n=r.n(i);let c=e=>{let{stigId:t,group:r}=e,i=(0,l.u2)(),c=[{href:"/stigs",text:"STIGs"}];if(t){let e=i.byId(t);c.push({href:"/stigs/".concat(t),text:"".concat(e.title)})}return r&&c.push({href:"/stigs/".concat(t,"/groups/").concat(r.id),text:"".concat(r.id)}),(0,s.jsx)("aside",{className:"flex flex-row items-center justify-start w-full",children:c.map((e,t)=>(0,s.jsxs)("span",{children:[(0,s.jsx)(n(),{className:"text-sm text-zinc-400",href:e.href,"aria-disabled":e.disabled,tabIndex:60,children:e.text}),t<c.length-1&&(0,s.jsxs)("span",{className:"text-sm mx-2 text-zinc-300",children:[" ",">"," "]})]},t))})}},6261:(e,t,r)=>{"use strict";r.d(t,{StigView:()=>w});var s=r(5155),l=r(2072),i=r(6094),n=r(2272),c=r(6874),a=r.n(c),o=r(2115),d=r(3522),x=r(7969),u=r(7597);let b={[i.AI.High]:4,[i.AI.Medium]:3,[i.AI.Low]:2,[i.AI.Info]:1},h=(e,t)=>b[t]-b[e],m=(e,t)=>{let r=h(e.rule.severity,t.rule.severity);return 0!==r?r:e.id.localeCompare(t.id)},f=[u.AG,h,u.AG,null],g=[null,null,u.kv,u.kv],v=[{text:"Group ID"},{text:"Severity",className:"text-center"},{text:"Title"},{text:"Description",className:"max-lg:hidden"}],j=(e,t)=>{let r=document.createElement("a");r.href=e,r.download=t,document.body.appendChild(r),r.click()},k=e=>{let t=new Blob([["Group ID,Severity,Title,Description,Rule ID,Fix ID,Fix Text,Check ID,Check Text",...e.groups.map(e=>[e.id,e.rule.severity,'"'.concat(e.rule.title,'"'),'"'.concat(e.rule.description,'"'),e.rule.id,e.rule.fix,'"'.concat(e.rule.fixText,'"'),e.rule.checkId,'"'.concat(e.rule.check,'"')].join(","))].join("\n")],{type:"text/csv"}),r=URL.createObjectURL(t);j(r,"".concat(e.id,".csv")),URL.revokeObjectURL(r)},p=e=>{let{classfication:t,selectedClassfication:r,setClassficationLevel:l,index:i,stigId:n}=e,c=t===r?"dark:bg-zinc-500 bg-zinc-200":"dark:bg-zinc-800 bg-white";return(0,s.jsx)(a(),{href:"/stigs/".concat(n,"/").concat(t),className:"px-4 py-2 text-sm font-medium text-zinc-900 border-zinc-200 hover:bg-zinc-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700  dark:border-zinc-700 dark:text-white dark:hover:text-white dark:hover:bg-zinc-700 dark:focus:ring-blue-500 dark:focus:text-white ".concat(c," ").concat(0===i?"rounded-s-lg border":"border-t border-b"," ").concat(2===i?"rounded-e-lg border":"border-t border-b"),onClick:()=>l(t),children:t})},w=e=>{let{stigId:t,classification:r}=e,i=(0,n.KR)(),[c,b]=(0,o.useState)(new Set),[h,w]=(0,o.useState)(r||l.Jq.Public),y=(0,o.useMemo)(()=>i.profilesByClassification,[i]),N=(0,o.useMemo)(()=>i.groupsByProfiles(Object.values(y[h]).flat()),[i,y]),I=(0,o.useMemo)(()=>{let e={};return Object.values(N).forEach(t=>{e[t.rule.severity]||(e[t.rule.severity]=0),e[t.rule.severity]++}),e},[N]),z=(0,o.useMemo)(()=>Object.values(N).filter(e=>0===c.size||c.has(e.rule.severity)).sort(m).map(e=>({values:[e.id,e.rule.severity,e.rule.title,e.rule.description],columns:[(0,s.jsx)(a(),{className:"flex flex-col whitespace-nowrap",href:"/stigs/".concat(t,"/groups/").concat(e.id),children:e.id}),(0,s.jsx)(x.P,{severity:e.rule.severity}),e.rule.title,e.rule.description],classNames:[null,null,null,"max-lg:hidden"]})),[N,t,c]),C=(0,o.useMemo)(()=>Object.values(l.Jq),[]);return(0,s.jsxs)(o.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading..."}),children:[(0,s.jsx)(d.B,{stigId:t}),(0,s.jsx)("h1",{className:"text-3xl mt-6",children:i.title}),(0,s.jsx)("p",{className:"text-base discussion",children:i.description}),(0,s.jsxs)("section",{className:"text-zinc-600 dark:text-zinc-500 text-xs w-full flex justify-between items-center",children:[(0,s.jsx)("aside",{className:"inline-flex rounded-md shadow-xs",role:"group",children:C.map((e,r)=>(0,s.jsx)(p,{stigId:t,classfication:e,selectedClassfication:h,setClassficationLevel:w,index:r},e))}),(0,s.jsxs)("div",{className:"text-zinc-600 dark:text-zinc-500 text-xs flex flex-col align-end text-end",children:[(0,s.jsxs)("span",{children:["Date: ",i.date.toLocaleDateString("sv-SE")]}),(0,s.jsxs)("span",{children:["Version: ",i.version]})]})]}),(0,s.jsxs)("section",{className:"w-full flex justify-between items-center",children:[(0,s.jsx)("div",{children:Object.entries(I).map(e=>{let[t,r]=e;return(0,s.jsx)(x.P,{severity:t,count:r,Element:"button",selected:c.has(t),onClick:()=>{let e=new Set(c);e.has(t)?e.delete(t):e.add(t),b(e)}},t)})}),(0,s.jsxs)("div",{className:"text-zinc-600 dark:text-zinc-500 text-xs flex",children:[(0,s.jsx)("button",{onClick:()=>j("/data/stigs/schema/".concat(i.id,".xml"),"".concat(i.id,".xml")),className:"text-zinc-600 dark:text-zinc-500 text-xs flex flex-col mr-4",children:"XML"}),(0,s.jsx)("button",{onClick:()=>j("/data/stigs/schema/".concat(i.id,".json"),"".concat(i.id,".json")),className:"text-zinc-600 dark:text-zinc-500 text-xs flex flex-col mr-4",children:"JSON"}),(0,s.jsx)("button",{onClick:()=>k(i),className:"text-zinc-600 dark:text-zinc-500 text-xs flex flex-col",children:"CSV"})]})]}),(0,s.jsx)("section",{className:"w-full flex flex-col",children:(0,s.jsx)("div",{className:"relative overflow-x-auto shadow-md sm:rounded-lg",children:(0,s.jsx)(u.XI,{sorters:f,filters:g,tableHeaders:v,tableBody:z})})})]})}},7969:(e,t,r)=>{"use strict";r.d(t,{P:()=>c});var s=r(5155),l=r(6094);let i={[l.AI.High]:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",[l.AI.Medium]:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",[l.AI.Low]:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",[l.AI.Info]:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300"},n={[l.AI.High]:"border border-red-200 dark:border-red-700",[l.AI.Medium]:"border border-orange-200 dark:border-orange-700",[l.AI.Low]:"border border-yellow-200 dark:border-yellow-700",[l.AI.Info]:"border border-blue-200 dark:border-blue-700"},c=e=>{let{severity:t,count:r,Element:l="span",onClick:c,selected:a=!1}=e,o=i[t];return a&&(o="".concat(o," ").concat(n[t])),(0,s.jsxs)(l,{className:"text-sm font-medium me-2 px-2.5 py-0.5 rounded-sm ".concat(o),onClick:c,children:[(0,s.jsx)("span",{children:t}),!isNaN(Number(r))&&(0,s.jsx)("span",{className:"text-xs ml-1",children:r})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[548,167,441,684,358],()=>t(2176)),_N_E=e.O()}]);